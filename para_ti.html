<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Para ti üåπ</title>
  <meta name="description" content="Tarjeta web con rosas, corazones y un mensaje personalizable por URL. 100% archivo √∫nico, lista para m√≥vil." />
  <style>
    :root {
      --bg1: #fde2e4;   /* rosa p√°lido */
      --bg2: #e8eafc;   /* lila suave */
      --card: rgba(255, 255, 255, 0.65);
      --text: #1f2937;  /* gris oscuro */
      --accent: #e11d48;/* fucsia */
      --accent-2: #7c3aed;/* violeta */
      --shadow: 0 10px 30px rgba(30, 27, 75, 0.15);
      --blur: saturate(160%) blur(8px);
    }
    [data-tema="noche"] {
      --bg1: #13151a;
      --bg2: #2a3b4d;
      --card: rgba(17, 24, 39, 0.6);
      --text: #e5e7eb;
      --accent: #fb7185;
      --accent-2: #93c5fd;
      --shadow: 0 10px 35px rgba(0,0,0,0.4);
      --blur: saturate(140%) blur(6px);
    }

    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 800px at 10% 10%, var(--bg1), transparent 70%),
                  radial-gradient(1000px 700px at 90% 20%, var(--bg2), transparent 60%),
                  linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
      min-height: 100svh;
      display: grid;
      place-items: center;
      overflow-x: hidden;
    }

    .wrap {
      width: min(920px, 92vw);
      padding: 24px;
    }

    .card {
      position: relative;
      background: var(--card);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      border: 1px solid rgba(255,255,255,0.35);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: clamp(18px, 3vw, 28px);
      overflow: hidden;
    }

    .cabecera {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 16px;
    }

    h1 {
      margin: 0;
      font-size: clamp(24px, 4.5vw, 42px);
      line-height: 1.05;
      letter-spacing: 0.2px;
      background: linear-gradient(92deg, var(--accent), var(--accent-2));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .sub {
      margin: 8px 0 0;
      font-size: clamp(14px, 1.9vw, 16px);
      opacity: 0.85;
    }

    .ramo {
      width: clamp(84px, 12vw, 120px);
      filter: drop-shadow(0 8px 16px rgba(0,0,0,0.12));
    }

    details.mensaje {
      margin-top: 16px;
      border-radius: 16px;
      border: 1px dashed rgba(255,255,255,0.6);
      background: rgba(255,255,255,0.3);
    }
    details[open].mensaje { background: rgba(255,255,255,0.45); }
    details > summary {
      list-style: none;
      cursor: pointer;
      padding: 14px 16px;
      font-weight: 600;
      display: flex;
      gap: 10px;
      align-items: center;
      user-select: none;
    }
    details > summary::marker { display: none; }
    .chip {
      display: inline-flex; align-items: center; gap: 8px;
      background: linear-gradient(92deg, var(--accent), var(--accent-2));
      color: white; font-weight: 700; letter-spacing: .3px;
      padding: 10px 14px; border-radius: 999px; font-size: 14px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }
    .contenido {
      padding: 4px 16px 16px;
      display: grid; gap: 10px;
      font-size: clamp(15px, 2vw, 18px);
    }
    .contenido p { margin: 0; }
    .firma { margin-top: 8px; font-weight: 600; }

    .galeria {
      margin-top: 14px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 12px;
    }
    .tile {
      aspect-ratio: 4/5;
      border-radius: 18px;
      background: linear-gradient(160deg, rgba(255,255,255,0.7), rgba(255,255,255,0.35));
      border: 1px solid rgba(255,255,255,0.5);
      display: grid; place-items: center;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .tile:hover { transform: translateY(-2px) scale(1.01); box-shadow: 0 12px 30px rgba(0,0,0,0.12); }
    .tile svg { width: 70%; height: 70%; }

    .acciones {
      margin-top: 18px;
      display: flex; flex-wrap: wrap; gap: 10px;
    }
    .btn {
      border: 0; border-radius: 999px; padding: 10px 14px; font-weight: 700;
      background: white; color: #111827; cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }
    .btn.principal { background: linear-gradient(92deg, var(--accent), var(--accent-2)); color: white; }

    .flotantes { /* corazones de fondo */
      position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: -1;
    }
    .corazon {
      position: absolute; opacity: .18; font-size: 20px; animation: subir linear infinite; filter: blur(.4px);
    }
    @keyframes subir { from { transform: translateY(100vh) scale(.8) rotate(0deg); } to { transform: translateY(-20vh) scale(1.2) rotate(45deg); } }

    footer { margin-top: 18px; font-size: 12px; opacity: .7; text-align: center; }

    /* Accesibilidad m√≠nima */
    :focus-visible { outline: 2px solid var(--accent-2); outline-offset: 3px; border-radius: 10px; }
  </style>
</head>
<body>
  <div class="flotantes" aria-hidden="true" id="fondo"></div>
  <div class="wrap" id="app">
    <article class="card" role="article" aria-label="Tarjeta con flores y mensaje">
      <header class="cabecera">
        <div>
          <h1>Para <span id="paraSpan">ti</span> ‚ù§</h1>
          <p class="sub">Un peque√±o detalle desde mi pantalla hasta la tuya.</p>
        </div>
        <svg class="ramo" viewBox="0 0 120 160" aria-hidden="true">
          <!-- Ramo minimalista: 3 rosas + tallos -->
          <defs>
            <linearGradient id="rojo" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#ff6b8b"/>
              <stop offset="100%" stop-color="#e11d48"/>
            </linearGradient>
            <linearGradient id="hoja" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#34d399"/>
              <stop offset="100%" stop-color="#059669"/>
            </linearGradient>
          </defs>
          <!-- Tallos -->
          <path d="M60 70 C 58 110, 55 150, 60 160" stroke="#065f46" stroke-width="2" fill="none"/>
          <path d="M50 70 C 48 110, 45 150, 50 160" stroke="#065f46" stroke-width="2" fill="none"/>
          <path d="M70 70 C 72 110, 75 150, 70 160" stroke="#065f46" stroke-width="2" fill="none"/>
          <!-- Hojas -->
          <path d="M55 105 C 40 95, 35 110, 55 120" fill="url(#hoja)"/>
          <path d="M65 115 C 85 105, 90 120, 65 130" fill="url(#hoja)"/>
          <!-- Rosas -->
          <g transform="translate(50,65)">
            <circle r="10" fill="url(#rojo)"/>
            <path d="M-6,-1 q6,-8 12,0 q-6,8 -12,0" fill="#fff3"/>
          </g>
          <g transform="translate(60,55)">
            <circle r="10" fill="url(#rojo)"/>
            <path d="M-6,-1 q6,-8 12,0 q-6,8 -12,0" fill="#fff3"/>
          </g>
          <g transform="translate(70,65)">
            <circle r="10" fill="url(#rojo)"/>
            <path d="M-6,-1 q6,-8 12,0 q-6,8 -12,0" fill="#fff3"/>
          </g>
          <!-- Lazo -->
          <ellipse cx="60" cy="130" rx="16" ry="6" fill="#f59e0b"/>
          <circle cx="60" cy="130" r="3" fill="#d97706"/>
        </svg>
      </header>

      <details class="mensaje">
        <summary><span class="chip" aria-label="Abrir mensaje">üíå Toca para abrir</span></summary>
        <div class="contenido">
          <p id="mensajeTexto">Hola. Solo quer√≠a decirte que ojal√° este d√≠a te regale sonrisas y calma. Aqu√≠ tienes un ramo de flores y un abrazo en forma de bits.</p>
          <p class="firma">Con cari√±o, <span id="deSpan">yo</span></p>
        </div>
      </details>

      <section class="galeria" aria-label="Ramos y flores decorativos">
        <div class="tile" aria-hidden="true">{SVG_RAMO}</div>
        <div class="tile" aria-hidden="true">{SVG_ROSA}</div>
        <div class="tile" aria-hidden="true">{SVG_RAMO}</div>
        <div class="tile" aria-hidden="true">{SVG_CORAZON}</div>
      </section>

      <div class="acciones">
        <button class="btn principal" id="btnCompartir">Compartir</button>
        <button class="btn" id="btnCopiar">Copiar enlace</button>
        <button class="btn" id="btnPersonalizar">Personalizar</button>
        <button class="btn" id="btnTema">Cambiar tema</button>
      </div>

      <footer>
        Funciona en m√≥vil. Personaliza con par√°metros: <code>Para ti.. </code>
      </footer>
    </article>
  </div>

  <dialog id="dlg" aria-label="Personalizar tarjeta">
    <form method="dialog" style="display:grid;gap:10px;min-width:min(92vw,420px)">
      <h3 style="margin:.2rem 0">Personaliza tu tarjeta</h3>
      <label>Para
        <input id="inPara" placeholder="Mar√≠a" style="width:100%;padding:10px;border-radius:10px;border:1px solid #d1d5db" />
      </label>
      <label>De
        <input id="inDe" placeholder="Alex" style="width:100%;padding:10px;border-radius:10px;border:1px solid #d1d5db" />
      </label>
      <label>Mensaje
        <textarea id="inMsg" rows="4" placeholder="Escribe algo bonito" style="width:100%;padding:10px;border-radius:10px;border:1px solid #d1d5db"></textarea>
      </label>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:4px">
        <button value="cancel" class="btn">Cancelar</button>
        <button id="guardar" class="btn principal">Actualizar</button>
      </div>
      <p id="linkGen" style="font-size:12px;opacity:.8;margin:.2rem 0 0"></p>
    </form>
  </dialog>

  <template id="svg-ramo">
    <svg viewBox="0 0 120 160" aria-hidden="true">
      <use href=".ramo #rojo"/>
      <use href=".ramo #hoja"/>
      <!-- reutilizamos un ramo simplificado -->
      <g transform="scale(.88) translate(7,5)">
        <path d="M60 70 C 58 110, 55 150, 60 160" stroke="#065f46" stroke-width="2" fill="none"/>
        <path d="M55 105 C 40 95, 35 110, 55 120" fill="#34d399"/>
        <g transform="translate(60,55)"><circle r="10" fill="url(#rojo)"/></g>
      </g>
    </svg>
  </template>
  <template id="svg-rosa">
    <svg viewBox="0 0 100 100" aria-hidden="true">
      <defs>
        <radialGradient id="r1" cx="50%" cy="50%" r="50%">
          <stop offset="0%" stop-color="#ffd1dc"/>
          <stop offset="100%" stop-color="#e11d48"/>
        </radialGradient>
      </defs>
      <circle cx="50" cy="50" r="28" fill="url(#r1)"/>
      <rect x="48" y="58" width="4" height="28" rx="2" fill="#047857"/>
      <path d="M52 66 C 78 66, 72 80, 52 78 Z" fill="#10b981"/>
      <path d="M48 70 C 22 70, 28 80, 48 78 Z" fill="#10b981"/>
    </svg>
  </template>
  <template id="svg-corazon">
    <svg viewBox="0 0 100 100" aria-hidden="true">
      <path d="M50 85 C 20 60, 10 40, 25 28 C 35 20, 50 25, 50 38 C 50 25, 65 20, 75 28 C 90 40, 80 60, 50 85 Z" fill="#ef4444"/>
    </svg>
  </template>

  <script>
    // Inserta SVGs de galer√≠a
    (() => {
      const ramo = document.getElementById('svg-ramo').content.cloneNode(true);
      const rosa = document.getElementById('svg-rosa').content.cloneNode(true);
      const cora = document.getElementById('svg-corazon').content.cloneNode(true);
      document.querySelectorAll('.tile').forEach((tile, i) => {
        tile.innerHTML = '';
        tile.appendChild([ramo, rosa, ramo, cora][i]);
      });
    })();

    // Corazones flotantes de fondo
    (function corazones() {
      const cont = document.getElementById('fondo');
      const n = 18;
      for (let i = 0; i < n; i++) {
        const s = document.createElement('span');
        s.className = 'corazon'; s.textContent = '‚ù§';
        s.style.left = Math.random() * 100 + 'vw';
        s.style.animationDuration = 12 + Math.random() * 10 + 's';
        s.style.animationDelay = -Math.random() * 10 + 's';
        s.style.fontSize = (14 + Math.random() * 24) + 'px';
        cont.appendChild(s);
      }
    })();

    // Personalizaci√≥n por URL
    function setTextFromParams() {
      const params = new URLSearchParams(location.search);
      const para = params.get('para') || 'ti';
      const de = params.get('de') || 'yo';
      const msg = params.get('msg') || 'Hola. Solo quer√≠a decirte que ojal√° este d√≠a te regale sonrisas y calma. Aqu√≠ tienes un ramo de flores y un abrazo en forma de bits.';
      document.getElementById('paraSpan').textContent = para;
      document.getElementById('deSpan').textContent = de;
      document.getElementById('mensajeTexto').innerHTML = escapeHTML(msg).replace(/\n/g, '<br>');
    }

    function escapeHTML(str){
      return str.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
    }

    setTextFromParams();

    // Acciones
    const btnCompartir = document.getElementById('btnCompartir');
    const btnCopiar = document.getElementById('btnCopiar');
    const btnTema = document.getElementById('btnTema');
    const btnPersonalizar = document.getElementById('btnPersonalizar');
    const dlg = document.getElementById('dlg');

    btnCompartir.addEventListener('click', async () => {
      const url = location.href;
      const titulo = 'Un detalle para ti üåπ';
      const texto = 'Te hice una tarjeta. √Åbrela cuando quieras.';
      if (navigator.share) {
        try { await navigator.share({ title: titulo, text: texto, url }); }
        catch(_){}
      } else {
        await navigator.clipboard.writeText(url);
        btnCompartir.textContent = 'Enlace copiado';
        setTimeout(() => btnCompartir.textContent = 'Compartir', 1500);
      }
    });

    btnCopiar.addEventListener('click', async () => {
      await navigator.clipboard.writeText(location.href);
      btnCopiar.textContent = 'Copiado ‚úÖ';
      setTimeout(() => btnCopiar.textContent = 'Copiar enlace', 1500);
    });

    // Tema claro/oscuro
    btnTema.addEventListener('click', () => {
      const actual = document.documentElement.getAttribute('data-tema');
      const nuevo = actual === 'noche' ? 'dia' : 'noche';
      document.documentElement.setAttribute('data-tema', nuevo);
      localStorage.setItem('tema-tarjeta', nuevo);
    });
    // Persistencia de tema
    (() => {
      const t = localStorage.getItem('tema-tarjeta');
      if (t) document.documentElement.setAttribute('data-tema', t);
    })();

    // Personalizar con modal
    btnPersonalizar.addEventListener('click', () => {
      const params = new URLSearchParams(location.search);
      document.getElementById('inPara').value = params.get('para') || '';
      document.getElementById('inDe').value = params.get('de') || '';
      document.getElementById('inMsg').value = params.get('msg') || '';
      dlg.showModal();
    });

    document.getElementById('guardar').addEventListener('click', (e) => {
      e.preventDefault();
      const p = new URLSearchParams(location.search);
      const para = document.getElementById('inPara').value.trim();
      const de = document.getElementById('inDe').value.trim();
      const msg = document.getElementById('inMsg').value.trim();
      if (para) p.set('para', para); else p.delete('para');
      if (de) p.set('de', de); else p.delete('de');
      if (msg) p.set('msg', msg); else p.delete('msg');
      const nueva = location.pathname + (p.toString() ? '?' + p.toString() : '');
      history.replaceState(null, '', nueva);
      setTextFromParams();
      const u = new URL(location.href);
      document.getElementById('linkGen').textContent = 'Nuevo enlace listo: ' + u.toString();
      dlg.close();
    });
  </script>
</body>
</html>
